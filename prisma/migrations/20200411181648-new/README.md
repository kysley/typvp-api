# Migration `20200411181648-new`

This migration has been generated by Evan Kysley at 4/11/2020, 6:16:48 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "ResultType" AS ENUM ('SINGLEPLAYER', 'RACE', 'TRIAL');

CREATE TYPE "Difficulty" AS ENUM ('EASY', 'NORMAL', 'MEDIUM', 'HARD');

CREATE TYPE "Role" AS ENUM ('USER', 'ADMIN', 'PRO', 'BETA');

CREATE TABLE "default$default"."Account" (
    "color" text   ,
    "confirmed" boolean  NOT NULL DEFAULT false,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "email" text  NOT NULL ,
    "id" text  NOT NULL ,
    "lastPlayed" text   ,
    "lastSeen" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "password" text  NOT NULL ,
    "role" "Role" NOT NULL DEFAULT 'USER',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "username" text  NOT NULL ,
    "usernameLowercase" text   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "default$default"."Test" (
    "account" text  NOT NULL ,
    "correct" integer  NOT NULL ,
    "corrections" integer  NOT NULL ,
    "cpm" integer  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "id" text  NOT NULL ,
    "incorrect" integer  NOT NULL ,
    "rawCpm" integer  NOT NULL ,
    "trial" text   ,
    "type" "ResultType" NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL ,
    "wordIndex" integer  NOT NULL ,
    "wpm" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "default$default"."Trial" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "custom" boolean   DEFAULT false,
    "difficulty" "Difficulty"  ,
    "id" text  NOT NULL ,
    "maxWordLength" integer   ,
    "minWordLength" integer   ,
    "name" text  NOT NULL ,
    "owner" text   ,
    "private" boolean   DEFAULT false,
    "updatedAt" timestamp(3)  NOT NULL ,
    "wordSet" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "Account.email" ON "default$default"."Account"("email")

CREATE UNIQUE INDEX "Account.username" ON "default$default"."Account"("username")

CREATE UNIQUE INDEX "Account.usernameLowercase" ON "default$default"."Account"("usernameLowercase")

ALTER TABLE "default$default"."Test" ADD FOREIGN KEY ("account")REFERENCES "default$default"."Account"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "default$default"."Test" ADD FOREIGN KEY ("trial")REFERENCES "default$default"."Trial"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "default$default"."Trial" ADD FOREIGN KEY ("owner")REFERENCES "default$default"."Account"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200411181648-new
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,85 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator typegraphql {
+  provider = "node_modules/typegraphql-prisma/generator.js"
+  output = "../src/generated/type-graphql"
+}
+
+model Account {
+  color             String?
+  confirmed         Boolean   @default(false)
+  createdAt         DateTime  @default(now())
+  email             String    @unique
+  id                String    @id @default(cuid())
+  lastPlayed        String?
+  lastSeen          DateTime  @default(now())
+  password          String
+  role              Role      @default(USER)
+  updatedAt         DateTime  @default(now())
+  username          String    @unique
+  usernameLowercase String?   @unique
+  Test              Test[]
+  Trial             Trial[]
+}
+
+model Test {
+  account     String
+  correct     Int
+  corrections Int
+  cpm         Int
+  createdAt   DateTime   @default(now())
+  id          String     @id @default(cuid())
+  incorrect   Int
+  rawCpm      Int
+  type        ResultType
+  updatedAt   DateTime
+  wordIndex   Int
+  wpm         Int
+  trial       String?
+  Account     Account    @relation(fields: [account], references: [id])
+  Trial       Trial?     @relation(fields: [trial], references: [id])
+}
+
+model Trial {
+  createdAt     DateTime    @default(now())
+  custom        Boolean?    @default(false)
+  difficulty    Difficulty?
+  id            String      @id @default(cuid())
+  maxWordLength Int?
+  minWordLength Int?
+  name          String
+  owner         String?
+  private       Boolean?    @default(false)
+  updatedAt     DateTime
+  wordSet       String
+  results       Trial[]
+  Account       Account?    @relation(fields: [owner], references: [id])
+}
+
+enum ResultType {
+  SINGLEPLAYER
+  RACE
+  TRIAL
+}
+
+enum Difficulty {
+  EASY
+  NORMAL
+  MEDIUM
+  HARD
+}
+
+enum Role {
+  USER
+  ADMIN
+  PRO
+  BETA
+}
+
```


